#!/usr/bin/env sh
#description: takes screenshot in 3.., 2.., 1, and saves the image in $HOME with a random name
#usage: screenshot

_notify ()
{
    [ X"$TERM" = X"linux" ] && notify-send -t 1000 "${@}" || printf "%s\\n" "${@}"
}

_exec()
{
    status=$?
    if [ X"$status" != X"0" ]; then
        exit $status
    fi
    printf "%s\\n" "[+] $@"
    eval "$@"
}

if [ -f /usr/bin/scrot ]; then
    screenshot_bin="scrot"
elif [ -f /usr/bin/import ]; then
    screenshot_bin="import -window root"
else
    _notify "[-] Error, install either import or scrot"
    exit 1
fi

file=$HOME/`</dev/urandom tr -dc A-Za-z0-9 | head -c 8`.png

_notify "[+] Screenshot" "in 3.., 2.., 1.., smile =)!"
_exec sleep 3
_exec "kill $(ps -aef | grep "notify-osd" | grep -v grep | awk '{print $2}') >/dev/null 2>/dev/null"
sleep .5
_exec $screenshot_bin $file
_notify "[+] Done" "$file"
